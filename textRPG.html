<!DOCTYPE html>
<html lang="kr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>text RPG</title>
  <style>
    .hero {
      color: royalblue;
      font-weight: 700;
    }

    .monster {
      color: tomato;
      font-weight: 700;
    }

    .lose {
      color: tomato;
    }

    ;

    .win {
      color: teal;
    }
  </style>
</head>

<body>
  <div id="app"></div>
  <script>
    const app = document.getElementById('app');
    const user = {
      hp: 100,
      att: 3,
      lv: 1,
      exp: 0,
    }
    const monster = [{
        name: '토끼',
        comment: '당근을 내놔랏!!',
        hp: 10,
        att: 15,
        exp: 35,
      },
      {
        name: '거북이',
        comment: '왜케 느려터져써? 비켜!!',
        hp: 20,
        att: 10,
        exp: 40,
      },
      {
        name: '모기',
        comment: '피가 모자라.....위이이잉',
        hp: 6,
        att: 5,
        exp: 20,
      },
      {
        name: '개구리',
        comment: '개굴개굴!!개굴개굴!!',
        hp: 8,
        att: 8,
        exp: 25,
      },
    ];
    let isCombatStatus = false;
    let isLive = true;
    let username = null;

    // function adventure(username) {
    //   for (; hero.hp > 0;) {
    //     const randomMonster = Math.floor(Math.random() * monster.length);
    //     const log = document.createElement('p');
    //     log.innerHTML =
    //       `<span class="hero">${username}</span>님은 <span class="monster">${monster[randomMonster].name}</span>를 만났습니다! 전투가 시작됩니다. `;
    //     app.appendChild(log);
    //     for (let k = 0; monster[randomMonster].hp > 0 && hero.hp > 0; k++) {
    //       monster[randomMonster].hp -= hero.att;
    //       hero.hp -= monster[randomMonster].att;
    //       if (monster[randomMonster].hp > 0) {
    //         const messageOne = document.createElement('p');
    //         messageOne.innerHTML =
    //           `<span class="hero">${username}</span>님의 공격에 <span class="monster">${monster[randomMonster].name}</span>의 체력이 ${monster[randomMonster].hp}이 되었습니다.`;
    //         app.appendChild(messageOne)
    //       } else {
    //         hero.exp += monster[randomMonster].exp;
    //         const messageOne = document.createElement('p');
    //         messageOne.innerHTML =
    //           `
    //           <span class="hero">${username}</span>님의 공격에 <span class="monster">${monster[randomMonster].name}</span>의 체력이 ${monster[randomMonster].hp <= 0?0:monster[randomMonster].hp}이 되었습니다.<br /><br />
    //           <span class="hero">${username}</span>님이 <span class="monster">${monster[randomMonster].name}</span>를 무찔렀습니다! <span class="win">[ 경험치 +${monster[randomMonster].exp}, 레벨: ${hero.exp >= 100 ? hero.lv += 1 : hero.lv}, 총 경험치: ${hero.exp} ]<span>`;
    //         app.appendChild(messageOne)
    //       }

    //       if (monster[randomMonster].hp > 0 && hero.hp > 0) {
    //         const messageTwo = document.createElement('p');
    //         messageTwo.innerHTML =
    //           `<span class="monster">${monster[randomMonster].name}</span>의 공격에 <span class="hero">${username}</span>님의 체력이 ${hero.hp}이 되었습니다.`;
    //         app.appendChild(messageTwo)
    //       } else if (monster[randomMonster].hp > 0 && hero.hp <= 0) {
    //         const messageTwo = document.createElement('p');
    //         messageTwo.innerHTML =
    //           `<span class="monster">${monster[randomMonster].name}</span>의 공격에 <span class="hero">${username}</span>님의 체력이 0이 되었습니다. <span class="lose">${monster[randomMonster].name}한테 패배해 버렸습니다...나약해..ㅜㅜ<span>`;
    //         app.appendChild(messageTwo)
    //       }
    //     }
    //   }
    // }

    // function start() {
    //   const username = prompt('용사님의 이름을 입력하세요(10자내외)');
    //   if (username) {
    //     const greeting = document.createElement('p');
    //     greeting.innerHTML = `<b>${username}</b>님의 모험이 시작됩니다. 용사님의 레벨은 ${hero.lv}, 체력은 ${hero.hp} 입니다`;
    //     app.appendChild(greeting);
    //   } else if (!username) {
    //     alert('용사님의 이름을 입력하지 않아 시작할 수 없어요. 다시 시작해주세요!(F5)')
    //   };
    //   adventure(username);
    // }


    function attackToUser(newMonster, random) {
      user.hp -= newMonster[random].att;

      if (user.hp > 0) {
        const message = document.createElement('p');
        message.innerHTML =
          `${newMonster[random].name}가 공격하여 <b>${username}</b>님의 체력이 ${user.hp}가 되었습니다.`;
        app.appendChild(message);
      }

      if (user.hp <= 0) {
        const message = document.createElement('p');
        message.innerHTML =
          `${newMonster[random].name}가 공격하여 <b>${username}</b>님의 체력이 모두 소진되었습니다. ${newMonster[random].name}한테 죽다니... 나약해....ㅜㅜ ▶[최종 레벨:${user.lv}, 경험치:${user.exp}]`;
        app.appendChild(message);
        isCombatStatus = false;
        isLive = false;
      }
    }

    function attackToMonster(newMonster, random) {
      newMonster[random].hp -= user.att;

      if (newMonster[random].hp > 0) {
        const message = document.createElement('p');
        message.innerHTML =
          `<b>${username}</b>님이 공격하여 ${newMonster[random].name}의 체력이 ${newMonster[random].hp}가 되었습니다.`;
        app.appendChild(message);
      }

      if (newMonster[random].hp <= 0) {
        user.exp += newMonster[random].exp;
        user.exp >= 100 ? (user.lv++, user.exp -= 100, user.att += 3, user.hp += 10) : user.exp;
        const message = document.createElement('p');
        message.innerHTML =
          `<b>${username}</b>님이 공격하여 ${newMonster[random].name}의 체력이 모두 소진되었습니다. <b>${username}</b>님이 승리했습니다! ▶[레벨:${user.lv}, 체력:${user.hp}, 공격력:${user.att}, 경험치:${user.exp}]`;
        app.appendChild(message);
        isCombatStatus = false;
        adventure();
      }
    }

    function adventure() {
      isCombatStatus = true;
      let newMonster = JSON.parse(JSON.stringify(monster))
      const random = Math.floor(Math.random() * newMonster.length);
      const message = document.createElement('p');
      message.innerHTML += `${newMonster[random].name}를 만났습니다! `;
      message.innerHTML += `  ${newMonster[random].name}왈, "${newMonster[random].comment}" `;
      message.innerHTML +=
        `  ▶(${newMonster[random].name} 체력:${newMonster[random].hp}, 공격력:${newMonster[random].att}, 경험치:${newMonster[random].exp})`;
      app.appendChild(message);
      for (; isCombatStatus;) {
        isCombatStatus && attackToMonster(newMonster, random)
        isCombatStatus && attackToUser(newMonster, random)
      }
    }

    function getUsername() {
      return username = prompt('용사님의 이름을 입력해주세요.');
    }

    function greeting(username) {
      const message = document.createElement('p');
      message.innerHTML =
        `<b>${username}</b>님의 모험이 시작됩니다. [레벨:${user.lv}, 체력:${user.hp}, 공격력:${user.att}, 경험치:${user.exp}]`;
      app.appendChild(message);
    }

    function init() {
      if (!username) {
        getUsername();
        greeting(username);
      }
      adventure();
    }

    init();
  </script>
</body>

</html>